---
title: "TypeScriptã®ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã¾ã¨ã‚"
emoji: "ðŸ™Œ"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ['TypeScript', 'fp-ts', 'neverthrow']
published: false
---

# Intro
ã“ã‚Œã¯[ã‚ªãƒ¼ãƒ—ãƒ³ãƒ­ã‚¸ã‚¢ãƒ‰ãƒ™ãƒ³ãƒˆã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼](https://qiita.com/advent-calendar/2024/openlogi)1æ—¥ç›®ã®è¨˜äº‹ã§ã™ã€‚

TypeScriptã¨ã„ã†ã‚ˆã‚ŠJavaScriptã§æ©Ÿèƒ½çš„ã«æä¾›ã•ã‚Œã¦ã„ã‚‹ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã¯try catchæ–‡ã ã‚ã†ã€‚
ãŸã ã€ãã‚Œã«ã¯èª²é¡ŒãŒã‚ã‚Šã€ãã‚Œã«å¯¾ã—ã¦ä»–ã®è¨€èªžã®è€ƒãˆæ–¹ã‚’å°Žå…¥ã—ã¦è§£æ±ºã—ãŸã‚Šã¨ã„ã†ã®ãŒã€ã‚ˆãè¦‹ã‚‰ã‚Œã‚‹ã€‚

ãã‚Œã‚‰ã‚’æ•´ç†ã—ã€ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã‚’ã©ã®ã‚ˆã†ã«æ›¸ãã¹ãã‹ã€è€ƒãˆã‚‹è£œåŠ©ã«ãªã‚‹è¨˜äº‹ã‚’ã¾ã¨ã‚ã¦ç½®ããŸã„ã€‚

TODO callbackã§è§£æ±ºã™ã‚‹ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚‚ã‚ã‚‹ã£ã½ã„ã€‚ãƒ¡ã‚¸ãƒ£ãƒ¼ãªã‚¤ãƒ¡ãƒ¼ã‚¸ãªã„ã‘ã©
https://typescript-jp.gitbook.io/deep-dive/type-system/exceptions#anatahaerwosursuruhaarimasen

# èª²é¡Œ
JavaScriptã§æ©Ÿèƒ½çš„ã«æä¾›ã•ã‚Œã¦ã„ã‚‹ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã¯try catchæ–‡ã§ã‚ã‚‹ã“ã¨ã¯ã™ã§ã«è¿°ã¹ãŸã€‚
ã“ã‚ŒãŒTypeScriptã«ãªã‚Šã€TypeScriptãŒæä¾›ã™ã‚‹åž‹ãƒã‚§ãƒƒã‚¯ã®ç¶²ã‚’ã™ã‚ŠæŠœã‘ã¦ã—ã¾ã†ä»•æ§˜ã®ãŸã‚ã€ã©ã†ã—ã¦ã‚‚TypeScriptã®æ©Ÿèƒ½ã‚’æ´»ã‹ã›ãªã„ã€‚

ä»¥ä¸‹ã¯MDNã®RangeErrorã®è§£èª¬ãƒšãƒ¼ã‚¸ã®å†…å®¹ã ãŒã€åž‹ã‚’ä»˜ã‘ã¦ã¿ãŸã‚‚ã®ã ã€‚

https://developer.mozilla.org/ja/docs/Web/JavaScript/Reference/Global_Objects/RangeError
```ts
function check(n: number): void {
  if (!(n >= -500 && n <= 500)) {
    throw new RangeError("The argument must be between -500 and 500.");
  }
}

try {
  check(2000);
} catch (error) {
  if (error instanceof RangeError) {
    // Handle the error
  }
}
```

checké–¢æ•°ã¯å€¤ã‚’è¿”ã•ãªã„`void`é–¢æ•°ãªã‚ã‘ã ãŒã€RangeErrorã«ãªã‚‹å¯èƒ½æ€§ã‚‚ã‚ã‚‹ã€‚
å¤–å´ã®try catchã‚’æ›¸ãã¹ãã‹å¦ã‹ã¯ã€é–¢æ•°ã®åž‹ã ã‘ã§ã¯åˆ¤æ–­ã§ããªã„ã€‚

ã§ã¯ã‚³ãƒ¼ãƒ‰ã‚’èª­ã‚ã°ã‚ˆã„ã¨ã„ã†æ„è¦‹ã‚‚ã‚ã‚‹ã‹ã‚‚ã—ã‚Œãªã„ãŒã€ä¸Šè¨˜ã®ä¾‹ã¯é™ã‚Šãªãç°¡å˜ãªä¾‹ã§ã‚ã‚Šã€å®Ÿéš›ã«ã¯æ›´ã«æ·±ã„call stackã®ä¸­ã§æŠ•ã’ã‚‰ã‚Œã¦ã„ã‚‹ä¾‹å¤–ãªã©ã¯æŠŠæ¡ã§ãã‚ˆã†ã¯ãšã‚‚ãªã„ã€‚
ã—ãŸãŒã£ã¦ã€catchç¯€ã§`instanceof`ã§åˆ¤å®šã™ã‚‹ã‚‚ã®ã‚‚ã€é–¢æ•°ã®ä¸­ã‚’è¦‹ãªã„ã¨æŠŠæ¡ã§ããªã„ã®ã ã€‚
ã“ã®ã‚ˆã†ã«é–¢æ•°ã®ã‚·ã‚°ãƒãƒãƒ£ã‚’èª­ã‚€ã ã‘ã§ã¯ã€é–¢æ•°ã®æŒ™å‹•ãŒæƒ³åƒã§ããªã„ã¨ã„ã†ã®ãŒã€try catchæ–‡ã®èª²é¡Œã ã€‚

# æ•´ç†
ä¸Šè¨˜ã®ä»•æ§˜ã‚’ã‚«ãƒãƒ¼ã—ã‚ˆã†ã¨ã€ãƒ—ãƒ­ã‚°ãƒ©ãƒžãƒ¬ãƒ™ãƒ«ã§ã¯æ§˜ã€…ãªå·¥å¤«ã‚’ã—ã¦ã„ã‚‹ã‚ˆã†ã ã€‚
ã©ã®ã‚„ã‚Šæ–¹ãŒã‚ˆãã¦ã€ã©ã‚ŒãŒæ‚ªã„ã¨ã„ã†ã“ã¨ã§ã¯ãªã„ãŒã€ãã‚Œã‚‰ã®ã‚„ã‚Šæ–¹ã‚’ãªã‚‹ã¹ãã™ã¹ã¦ãƒ†ãƒ¼ãƒ–ãƒ«ã«ä¹—ã›ã€æ¯”è¼ƒæ¤œè¨Žã—ãŸã„ã€‚
å½“ç„¶try catchã‚‚å«ã‚ã¦æ¯”è¼ƒæ¤œè¨Žã™ã‚‹ã€‚

å€‹åˆ¥ã®ã‚„ã‚Šæ–¹ãŒã‚ã‚‹ã€‚ã¨ã„ã†ã‚ˆã‚Šã¯ã€ã„ãã¤ã‹ã®ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ãƒ†ã‚¯ãƒ‹ãƒƒã‚¯ã®è¤‡åˆã¨ã—ã¦ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚¹ã‚¿ã‚¤ãƒ«ãŒç”Ÿã¾ã‚Œã¦ã„ã‚‹ã®ã§ã€ãã®å„è¦ç´ ã‚’ä¸¦ã¹ãŸå¾Œã€ãã®çµ„ã¿åˆã‚ã›æ–¹ã®ä¾‹ã‚’ã„ãã¤ã‹è¿°ã¹ã¦ã„ãã€‚

## ã‚¨ãƒ©ãƒ¼ã¨ä¾‹å¤–
ã¾ãšã¯ã€å˜èªžã«ã¤ã„ã¦æ•´ç†ã—ãŸã„ã€‚
JavaScriptã§ã¯ã€æ¨™æº–classã¨ã—ã¦ErrorãŒã‚ã‚‹ã€‚ã‚¨ãƒ©ãƒ¼ã ã€‚
ä¾‹å¤–ã¯ã©ã¡ã‚‰ã‹ã¨ã„ã†ã¨ã€`ä¾‹å¤–å‡¦ç†`ã¨ã„ã†å˜èªžã§ã€try catchæ–‡ã‚’ç¤ºã™ã“ã¨ãŒãŠãŠã„ã®ã§ã¯ãªã„ã ã‚ã†ã‹ã€‚

ä¸Šè¨˜ã®å®šç¾©ã«å‰‡ã‚‹ã®ã§ã‚ã‚Œã°ã€ã“ã®è¨˜äº‹ã§ã¯åŸºæœ¬çš„ã«ä¾‹å¤–ã¨ã„ã†å˜èªžã¯ç”¨ã„ãªã„ã€‚

ã‚¨ãƒ©ãƒ¼ã«ã¤ã„ã¦ã‚‚`Error`ã‚¯ãƒ©ã‚¹ã‚’ç¶™æ‰¿ã—ã¦ã„ã‚Œã°ã‚¨ãƒ©ãƒ¼ãªã®ã‹ï¼Ÿã¨ã„ã†ç‚¹ã‚‚æ›–æ˜§ã ã€‚
ã‚¨ãƒ©ãƒ¼ã«ã¤ã„ã¦ã¯ã€ä½•ã‚‰ã‹ã®ä¸éƒ½åˆã¨å®šç¾©ã—ã¦ã‚‚ã„ã„ã‹ã‚‚ã—ã‚Œãªã„ã€‚å°‘ãªãã¨ã‚‚æœ¬è¨˜äº‹ã§ã¯ã€`Error`ã‚¯ãƒ©ã‚¹ã‚’ç¶™æ‰¿ã—ã¦ã„ã‚‹ã“ã¨ã‚’ã€ã‚¨ãƒ©ãƒ¼ã®æ¡ä»¶ã¨ã¯ã—ãªã„ã€‚
`Error`ã‚¯ãƒ©ã‚¹ã«ã¤ã„ã¦ã¯ã€å¾Œã§å‡ºã¦ãã‚‹ã®ã§ã€æ˜Žç¢ºã«`Error`ã‚¯ãƒ©ã‚¹ã¨è¡¨ç¾ã™ã‚‹ã€‚

ã‚¨ãƒ©ãƒ¼ã«ã¤ã„ã¦ã¯ã€å¹…ã®åºƒã„å˜èªžãªã®ã§ã€æ¬¡ç¯€ã§æ›´ã«è¨€åŠã™ã‚‹

## ã‚¨ãƒ©ãƒ¼ã®ç¨®é¡ž
ã‚¨ãƒ©ãƒ¼ã¨ä¾‹å¤–ã‚’åŒºåˆ¥ã—ãŸãŒã€ã‚¨ãƒ©ãƒ¼ã«ã‚‚æ§˜ã€…ã‚ã‚‹ã ã‚ã†ã€‚

- ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®åˆ©ç”¨è€…ã®æ„å›³é€šã‚Šã«ãªã‚‰ãªã„æŒ™å‹•
- ãƒ©ã‚¤ãƒ–ãƒ©ãƒªãŒæŠ•ã’ã‚‹`Error`ã‚¯ãƒ©ã‚¹
- TypeScriptã®ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚¨ãƒ©ãƒ¼

ã©ã‚Œã‚‚ã‚¨ãƒ©ãƒ¼ã ã€‚

## ã‚¨ãƒ©ãƒ¼ã®è¡¨ç¾
- numbar
- string
- object
- class
- error class

## ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
- return error
- throw error

## return anything
- union
- tuple
- object
- optional/maybe
- result/either
- other class

## ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚¹ã‚¿ã‚¤ãƒ«
- try catch
- early return
- railway oriented

## railway orientedã®é©ç”¨
- ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹
- ã‚µãƒ¼ãƒ“ã‚¹
- IO
- utility

é•·ã„ã¨ã“ã‚ã«ä½¿ã„ãŸã„

## fp-ts
- fp-ts
- neverthrow
- effect

è©¦ã—ãŸPR
https://github.com/motojouya/croaker/pull/42

## neverthrow

è£œã†ã‚³ãƒ¼ãƒ‰ã€‚ã“ã‚ŒãŒã‚ã‚Œã°fp-tsã¨åŒç­‰ã®ã“ã¨ãŒã§ããã†
```ts
const constant = (key, func) => (carry) => {

  if (carry.isError) {
    return carry;
  }

  const result = func(carry);

  if (result.isError) {
    return result;
  }

  return new Success({
    ...carry,
    [key]: result.result,
  });
}
```

## outro

