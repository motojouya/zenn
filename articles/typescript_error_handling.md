---
title: "TypeScriptã®ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã¾ã¨ã‚"
emoji: "ğŸ™Œ"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ['TypeScript', 'fp-ts', 'neverthrow']
published: false
---

# Intro
ã“ã‚Œã¯[ã‚ªãƒ¼ãƒ—ãƒ³ãƒ­ã‚¸ã‚¢ãƒ‰ãƒ™ãƒ³ãƒˆã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼](https://qiita.com/advent-calendar/2024/openlogi)1æ—¥ç›®ã®è¨˜äº‹ã§ã™ã€‚

TypeScriptã¨ã„ã†ã‚ˆã‚ŠJavaScriptã§æ©Ÿèƒ½çš„ã«æä¾›ã•ã‚Œã¦ã„ã‚‹ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã¯try catchæ–‡ã ã‚ã†ã€‚
ãŸã ã€ãã‚Œã«ã¯èª²é¡ŒãŒã‚ã‚Šã€ãã‚Œã«å¯¾ã—ã¦ä»–ã®è¨€èªã®è€ƒãˆæ–¹ã‚’å°å…¥ã—ã¦è§£æ±ºã—ãŸã‚Šã¨ã„ã†ã®ãŒã€ã‚ˆãè¦‹ã‚‰ã‚Œã‚‹ã€‚

ãã‚Œã‚‰ã‚’æ•´ç†ã—ã€ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã‚’ã©ã®ã‚ˆã†ã«æ›¸ãã¹ãã‹ã€è€ƒãˆã‚‹è£œåŠ©ã«ãªã‚‹è¨˜äº‹ã‚’ã¾ã¨ã‚ã¦ç½®ããŸã„ã€‚

# èª²é¡Œ
JavaScriptã§æ©Ÿèƒ½çš„ã«æä¾›ã•ã‚Œã¦ã„ã‚‹ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã¯try catchæ–‡ã§ã‚ã‚‹ã“ã¨ã¯ã™ã§ã«è¿°ã¹ãŸã€‚
ã“ã‚ŒãŒTypeScriptã«ãªã‚Šã€TypeScriptãŒæä¾›ã™ã‚‹å‹ãƒã‚§ãƒƒã‚¯ã®ç¶²ã‚’ã™ã‚ŠæŠœã‘ã¦ã—ã¾ã†ä»•æ§˜ã®ãŸã‚ã€ã©ã†ã—ã¦ã‚‚TypeScriptã®æ©Ÿèƒ½ã‚’æ´»ã‹ã›ãªã„ã€‚

ä»¥ä¸‹ã¯MDNã®RangeErrorã®è§£èª¬ãƒšãƒ¼ã‚¸ã®å†…å®¹ã ãŒã€å‹ã‚’ä»˜ã‘ã¦ã¿ãŸã‚‚ã®ã ã€‚

https://developer.mozilla.org/ja/docs/Web/JavaScript/Reference/Global_Objects/RangeError
```ts
function check(n: number): void {
  if (!(n >= -500 && n <= 500)) {
    throw new RangeError("The argument must be between -500 and 500.");
  }
}

try {
  check(2000);
} catch (error) {
  if (error instanceof RangeError) {
    // Handle the error
  }
}
```

checké–¢æ•°ã¯å€¤ã‚’è¿”ã•ãªã„`void`é–¢æ•°ãªã‚ã‘ã ãŒã€RangeErrorã«ãªã‚‹å¯èƒ½æ€§ã‚‚ã‚ã‚‹ã€‚
å¤–å´ã®try catchã‚’æ›¸ãã¹ãã‹å¦ã‹ã¯ã€é–¢æ•°ã®å‹ã ã‘ã§ã¯åˆ¤æ–­ã§ããªã„ã€‚

ã§ã¯ã‚³ãƒ¼ãƒ‰ã‚’èª­ã‚ã°ã‚ˆã„ã¨ã„ã†æ„è¦‹ã‚‚ã‚ã‚‹ã‹ã‚‚ã—ã‚Œãªã„ãŒã€ä¸Šè¨˜ã®ä¾‹ã¯é™ã‚Šãªãç°¡å˜ãªä¾‹ã§ã‚ã‚Šã€å®Ÿéš›ã«ã¯æ›´ã«æ·±ã„call stackã®ä¸­ã§æŠ•ã’ã‚‰ã‚Œã¦ã„ã‚‹ä¾‹å¤–ãªã©ã¯æŠŠæ¡ã§ãã‚ˆã†ã¯ãšã‚‚ãªã„ã€‚
ã—ãŸãŒã£ã¦ã€catchç¯€ã§`instanceof`ã§åˆ¤å®šã™ã‚‹ã‚‚ã®ã‚‚ã€é–¢æ•°ã®ä¸­ã‚’è¦‹ãªã„ã¨æŠŠæ¡ã§ããªã„ã®ã ã€‚
ã“ã®ã‚ˆã†ã«é–¢æ•°ã®ã‚·ã‚°ãƒãƒãƒ£ã‚’èª­ã‚€ã ã‘ã§ã¯ã€é–¢æ•°ã®æŒ™å‹•ãŒæƒ³åƒã§ããªã„ã¨ã„ã†ã®ãŒã€try catchæ–‡ã®èª²é¡Œã ã€‚

# æ•´ç†
ä¸Šè¨˜ã®ä»•æ§˜ã‚’ã‚«ãƒãƒ¼ã—ã‚ˆã†ã¨ã€ãƒ—ãƒ­ã‚°ãƒ©ãƒãƒ¬ãƒ™ãƒ«ã§ã¯æ§˜ã€…ãªå·¥å¤«ã‚’ã—ã¦ã„ã‚‹ã‚ˆã†ã ã€‚
ã©ã®ã‚„ã‚Šæ–¹ãŒã‚ˆãã¦ã€ã©ã‚ŒãŒæ‚ªã„ã¨ã„ã†ã“ã¨ã§ã¯ãªã„ãŒã€ãã‚Œã‚‰ã®ã‚„ã‚Šæ–¹ã‚’ãªã‚‹ã¹ãç¶²ç¾…ã—ã¦ãƒ†ãƒ¼ãƒ–ãƒ«ã«ä¹—ã›ã€æ¯”è¼ƒæ¤œè¨ã—ãŸã„ã€‚å½“ç„¶try catchã‚‚å«ã‚ã‚‹ã€‚

å€‹åˆ¥ã®ã‚„ã‚Šæ–¹ãŒã‚ã‚‹ã€‚ã¨ã„ã†ã‚ˆã‚Šã¯ã€ã„ãã¤ã‹ã®ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ãƒ†ã‚¯ãƒ‹ãƒƒã‚¯ã®è¤‡åˆã¨ã—ã¦ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚¹ã‚¿ã‚¤ãƒ«ãŒç”Ÿã¾ã‚Œã¦ã„ã‚‹ã®ã§ã€ãã®å„è¦ç´ ã‚’ä¸¦ã¹ãŸå¾Œã€ãã®çµ„ã¿åˆã‚ã›æ–¹ã®ä¾‹ã‚’ã„ãã¤ã‹è¿°ã¹ã¦ã„ãã€‚

## ã‚¨ãƒ©ãƒ¼ã¨ä¾‹å¤–
ã¾ãšã¯ã€å˜èªã«ã¤ã„ã¦æ•´ç†ã—ãŸã„ã€‚
JavaScriptã§ã¯ã€æ¨™æº–classã¨ã—ã¦ErrorãŒã‚ã‚‹ã€‚ã‚¨ãƒ©ãƒ¼ã ã€‚
ä¾‹å¤–ã¯ã©ã¡ã‚‰ã‹ã¨ã„ã†ã¨ã€`ä¾‹å¤–å‡¦ç†`ã¨ã„ã†å˜èªã§ã€try catchæ–‡ã‚’ç¤ºã™ã“ã¨ãŒãŠãŠã„ã®ã§ã¯ãªã„ã ã‚ã†ã‹ã€‚

ä¸Šè¨˜ã®å®šç¾©ã«å‰‡ã‚‹ã®ã§ã‚ã‚Œã°ã€ã“ã®è¨˜äº‹ã§ã¯åŸºæœ¬çš„ã«ä¾‹å¤–ã¨ã„ã†å˜èªã¯ç”¨ã„ãªã„ã€‚

ã‚¨ãƒ©ãƒ¼ã«ã¤ã„ã¦ã‚‚`Error`ã‚¯ãƒ©ã‚¹ã‚’ç¶™æ‰¿ã—ã¦ã„ã‚Œã°ã‚¨ãƒ©ãƒ¼ãªã®ã‹ï¼Ÿã¨ã„ã†ç‚¹ã‚‚æ›–æ˜§ã ã€‚
ã‚¨ãƒ©ãƒ¼ã«ã¤ã„ã¦ã¯ã€ä½•ã‚‰ã‹ã®ä¸éƒ½åˆã¨å®šç¾©ã—ã¦ã‚‚ã„ã„ã‹ã‚‚ã—ã‚Œãªã„ã€‚å°‘ãªãã¨ã‚‚æœ¬è¨˜äº‹ã§ã¯ã€`Error`ã‚¯ãƒ©ã‚¹ã‚’ç¶™æ‰¿ã—ã¦ã„ã‚‹ã“ã¨ã‚’ã€ã‚¨ãƒ©ãƒ¼ã®æ¡ä»¶ã¨ã¯ã—ãªã„ã€‚
`Error`ã‚¯ãƒ©ã‚¹ã«ã¤ã„ã¦ã¯ã€å¾Œã§å‡ºã¦ãã‚‹ã®ã§ã€æ˜ç¢ºã«`Error`ã‚¯ãƒ©ã‚¹ã¨è¡¨ç¾ã™ã‚‹ã€‚

ã‚¨ãƒ©ãƒ¼ã«ã¤ã„ã¦ã¯ã€å¹…ã®åºƒã„å˜èªãªã®ã§ã€æ¬¡ç¯€ã§æ›´ã«è¨€åŠã™ã‚‹

## ã‚¨ãƒ©ãƒ¼ã®ç¨®é¡
ã‚¨ãƒ©ãƒ¼ã¨ä¾‹å¤–ã‚’åŒºåˆ¥ã—ãŸãŒã€ã‚¨ãƒ©ãƒ¼ã«ã‚‚æ§˜ã€…ã‚ã‚‹ã ã‚ã†ã€‚

### TypeScriptã®ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚¨ãƒ©ãƒ¼
åŸºæœ¬çš„ã«ã¯é–‹ç™ºæ™‚ã«ä¿®æ­£ã™ã‚‹ã‚‚ã®ã ã‚ã†ã€‚è§£æ±ºã§ããªã‘ã‚Œã°@ts-ignoreã‚’ã¤ã‘ã‚‹ã“ã¨ã‚‚ã‚ã‚‹ã‹ã‚‚ã—ã‚Œãªã„ã€‚
å®Ÿè¡Œæ™‚ã«ç™ºç”Ÿã™ã‚‹ã“ã¨ã¯æƒ³å®šã—ãªã„ã€‚

### ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‹ã‚‰æŠ•ã’ã‚‰ã‚Œã‚‹ã‚¨ãƒ©ãƒ¼
ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚„æ¨™æº–APIã‹ã‚‰æŠ•ã’ã‚‰ã‚Œã‚‹ã‚‚ã®ã ã€‚
ãƒ—ãƒ­ã‚°ãƒ©ãƒãŒæ„å›³ã—ã¦ä½¿ãˆã‚Œã°ã‚ˆã„ãŒã€ä»•æ§˜ã‚’ç†è§£ã—ãªã‘ã‚Œã°ã‚­ãƒãƒ³ã¨ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã§ããªã„ã€‚

### ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§å®šç¾©ã•ã‚Œã¦ã„ã‚‹ã‚¨ãƒ©ãƒ¼
ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§å®šç¾©ã•ã‚Œã¦ã„ã‚‹ã‚¨ãƒ©ãƒ¼ã ã€‚ã“ã‚Œã¯ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’æ›¸ããƒ—ãƒ­ã‚°ãƒ©ãƒãŒçŸ¥ã‚Šã€å®šç¾©ã—ã€ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã™ã‚‹ã€‚

### åˆ©ç”¨è€…ã®æ„å›³é€šã‚Šã«ãªã‚‰ãªã„æŒ™å‹•
ã‚¨ãƒ©ãƒ¼ã¨ã—ã¦ã¯å®šç¾©ã—ãªã„ã‹ã‚‚ã—ã‚Œãªã„ãŒã€åˆ©ç”¨è€…ã®æ„å›³é€šã‚Šã«ãªã‚‰ãªã„ã‚‚ã®ã ã€‚
å†…éƒ¨çš„ã«ã‚¨ãƒ©ãƒ¼ã¨ã—ã¦æ‰±ã‚ãªã„ã“ã¨ã‚‚ã‚ã‚‹ã‹ã‚‚ã—ã‚Œãªã„ãŒã€å†…éƒ¨çš„ã«ã‚¨ãƒ©ãƒ¼ã‚’æŠ•ã’ã¦ã‚­ãƒ£ãƒƒãƒã—ã€ç”»é¢ã«è¡¨ç¤ºã™ã‚‹ã‹ã‚‚ã—ã‚Œãªã„ã€‚

## ã‚¨ãƒ©ãƒ¼ã®è¡¨ç¾

### number
ã‚¨ãƒ©ãƒ¼ã‚³ãƒ¼ãƒ‰ã¨ã—ã¦å®šç¾©ã•ã‚Œã‚‹ã‚‚ã®ã«ãªã‚‹ã€‚
åŸºæœ¬çš„ã«ã¯æ¡æ•°ã‚’æ±ºã‚ã¦æ•´æ•°ã§å®šç¾©ã™ã‚‹ã ã‚ã†ã€‚

```ts
type ErrorCode = 404 | 403 | 500;
```

è»½é‡ã§ã¯ã‚ã‚‹ãŒã€ä½•ã‚’æ„å›³ã—ã¦ã„ã‚‹ã‚‚ã®ãªã®ã‹ã‚ã‹ã‚Šã¥ã‚‰ã„ã‹ã‚‚ã—ã‚Œãªã„ã€‚
ã¾ãŸä¾‹ã¯HTTP status codeã‚’æƒ³å®šã—ã¦ã„ã‚‹ãŒã€status codeã§ã¯è¡¨ç¾ã—ã¥ã‚‰ã„ã‚‚ã®ã‚‚å½“ç„¶ã‚ã‚‹ã€‚

### string
ã“ã¡ã‚‰ã¯ã‚¨ãƒ©ãƒ¼ã‚³ãƒ¼ãƒ‰çš„ã«å®šç¾©ã•ã‚Œã¦ã„ã‚‹ã‚‚ã®ã‚‚ã‚ã‚Œã°ã€å˜ã«æ–‡ç« ã«ãªã£ã¦ã„ã‚‹ã‚‚ã®ã‚‚ã‚ã‚‹ã€‚

```ts
type ErrorCode = 'NOT_FOUND' | 'NO_AUTH' | 'SERVER_ERROR';
```

ã‚¨ãƒ©ãƒ¼ã‚³ãƒ¼ãƒ‰ã¯å‹ã¨ã—ã¦å®šç¾©ã§ãã‚‹ãŒã€ä»¥ä¸‹ã®ã‚ˆã†ã«ä»»æ„ã®æ–‡ç« ã‚’ã‚¨ãƒ©ãƒ¼ã¨ã—ã¦è¡¨ç¾ã™ã‚‹ã®ã¯é™ç•ŒãŒã‚ã‚‹ã ã‚ã†ã€‚
å®šç¾©ã—ãŸé–¢æ•°ã®ã‚¹ã‚³ãƒ¼ãƒ—ã‚’æŠœã‘ã‚‹ã¨ãŸã ã®stringã§ã‚ã‚Šã€åˆ¤åˆ¥ãŒã¤ã‹ãªã„ã€‚

```ts
function someError() {
  return 'some error happend';
}
```

### object
### class
### extends error

## ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
- return error
- throw error

## return anything
- union
- tuple
- object
- optional/maybe
- result/either
- other class

## ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚¹ã‚¿ã‚¤ãƒ«
- try catch style
- golang style
- railway oriented style

## railway orientedã®é©ç”¨
- ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹
- ã‚µãƒ¼ãƒ“ã‚¹
- IO
- utility

é•·ã„ã¨ã“ã‚ã«ä½¿ã„ãŸã„

## fp-ts
- fp-ts
- neverthrow
- effect

è©¦ã—ãŸPR
https://github.com/motojouya/croaker/pull/42

## neverthrow

è£œã†ã‚³ãƒ¼ãƒ‰ã€‚ã“ã‚ŒãŒã‚ã‚Œã°fp-tsã¨åŒç­‰ã®ã“ã¨ãŒã§ããã†
```ts
const constant = (key, func) => (carry) => {

  if (carry.isError) {
    return carry;
  }

  const result = func(carry);

  if (result.isError) {
    return result;
  }

  return new Success({
    ...carry,
    [key]: result.result,
  });
}
```

TODO callbackã§è§£æ±ºã™ã‚‹ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚‚ã‚ã‚‹ã£ã½ã„ã€‚ãƒ¡ã‚¸ãƒ£ãƒ¼ãªã‚¤ãƒ¡ãƒ¼ã‚¸ãªã„ã‘ã©
https://typescript-jp.gitbook.io/deep-dive/type-system/exceptions#anatahaerwosursuruhaarimasen


## outro

