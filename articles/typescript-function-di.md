---
title: "TypeScriptの関数でコーディングする際のDIのようななにか"
emoji: "🙌"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: ['TypeScirpt']
published: false
---

## intro

## 難解な機能
class
generics
async/await
他にも

## 考えたかた
難解な機能は避けつつ、メタなコードはアプリケーションに必要。選んで機能が重複しないように
またライブラリ寄りならしかたないがアプリはより注意深く
tsの型レベルプログラミングも、自由にするのではなく、1-100までの整数や、stringのunionのような、プログラマが把握できる制約まで狭めた範囲ならよい。


## DIとは
classの上に乗せた機能だが、classの考え方を基本にするなら、自然な機能

- DI
  - classベースの考え方
- DIコンテナ
- 関数において先にbindすること

## DIの目的
- テスト
- 実装の切り替え
  - 将来的
  - 現在の実装

## ライブラリの扱い
wrapしましょう
- 付け替えを内部でできる
- ライブラリ利用のスコープを限定
- ライブラリの違いを吸収
  - 引数
  - 戻り値
  - 例外

## 実装の付け替え
実装として、アプリケーションの中で付け替えるのであれば、DIコンテナではないはず。
アプリケーションの機能として実装するのだから、DIはしてもコンテナで管理の必要はないのでは

## テスト
必要。ただし、主たる処理があり、サブな位置づけで

## 関数での実装
コードと利用例

## 特徴
上記コードの特徴とpros/cons

## つらみ
多重でDIする際には、生成知識がいる。
いずれにしろ、生成知識というやつは、アプリケーションコード上に実装する。
量が多ければ難しくなる。

けれど、多重にするにしても、2レイヤ程度ではないか
`ユースケース -> サービス -> リポジトリ`

ただし、この構造では、ユースケースがリポジトリの何にアクセスしているか、知らない。
外界に作用を引き起こす処理がなんなのか、ユースケース上で把握できるのは、よいこと。

関数なら、callbackを渡すことで、比較的かんたんにDIっぽい動きができるので、コード量もすくなくて済みやすい。

## outro

